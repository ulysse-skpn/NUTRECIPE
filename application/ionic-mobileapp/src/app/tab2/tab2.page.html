<app-side-menu></app-side-menu>

<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>
      Accueil
    </ion-title>
    <ion-menu-button slot="end" class="side-menu-button"></ion-menu-button>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">

  <ion-segment [(ngModel)]="selectTab">
    <ion-segment-button value="card">
      <ion-label>Carte</ion-label>
    </ion-segment-button>
    <ion-segment-button value="list">
      <ion-label>Icône</ion-label>
    </ion-segment-button>
  </ion-segment>

  <ion-searchbar inputmode="search" animated debounce="800" [(ngModel)]="searchTerm"></ion-searchbar>

  <div *ngIf="selectTab === 'card'">

    <ion-list>
  
       <ion-card *ngFor="let ingredient of ingredientList | filter:searchTerm" (click)="expand(ingredient)">
          
          <ion-card-content>
            
            <img src="{{ ingredient.image }}" alt="image indisponible">
            <ion-card-title  (click)="detail($event , ingredient.ingredientId)">{{ ingredient.product_name }}</ion-card-title>

            <ion-fab horizontal="end" vertical="bottom" slot="fixed" (click)="bookmark( $event , ingredient)" *ngIf="connected">
              <ion-fab-button color="light">
                <ion-icon class="bookmarkIcon" [ngClass]="{
                  bookmarked: ingredient.isBookmarked == true,
                  notBookmarked: ingredient.isBookmarked == false
                }" name="heart-circle"></ion-icon>
              </ion-fab-button>
            </ion-fab>

            <div *ngIf="ingredient.expanded">
              {{ ingredient.ingredient_text }}
            </div>
            
          </ion-card-content>
        </ion-card>
    </ion-list>

  </div>

  <div *ngIf="selectTab === 'list'">

    <ion-list>

      <ion-grid>
        <ion-row>
          <ion-col sizeXs="6" *ngFor="let ingredient of ingredientList | filter:searchTerm">
            <ion-card class="card" (click)="detail($event , ingredient.ingredientId)">
              <ion-card-content>
                
                <ion-avatar>
                  <img src="{{ ingredient.image }}" alt="image indisponible">
                </ion-avatar>
                <ion-card-title ionButton class="ionCardTitle">{{ ingredient.product_name }}</ion-card-title>

                <div *ngIf="connected">
                  <button class="alignBookmarkButtons" slot="end" (click)="bookmark($event , ingredient)">
                      <ion-icon class="bookmarkIcon" [ngClass]="{
                        bookmarked: ingredient.isBookmarked == true,
                        notBookmarked: ingredient.isBookmarked == false
                      }" name="heart-circle"></ion-icon>
                  </button>
                </div>

                <div *ngIf="ingredient.expanded">
                  {{ ingredient.ingredient_text }}
                </div>
                
              </ion-card-content>
            </ion-card>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-list>

  </div>

  <ion-infinite-scroll threshold="1000px" (ionInfinite)="loadData($event)">
    <ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="Chargement des données..."></ion-infinite-scroll-content>
  </ion-infinite-scroll>

</ion-content>

